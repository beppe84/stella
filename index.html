<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Meeting in Malmö between</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>

    <div class="full-screen-content"> 
        <h1>Meeting in Malmö between</h1>
        
        <p id="status-message"></p>
        
        <div class="digital-countdown">
            
            <div class="time-group">
                <span id="hours-number" class="number">00</span>
                <span class="label">Hours</span>
            </div>
            
            <div id="heart-1" class="heart-separator">
                <svg viewBox="0 0 100 100" class="heart-svg">
                    <path d="M50,90 C-10,40 10,0 50,20 C90,0 110,40 50,90 Z" fill="#61dafb"/>
                </svg>
            </div>
            
            <div class="time-group">
                <span id="minutes-number" class="number">00</span>
                <span class="label">Minutes</span>
            </div>
            
            <div id="heart-2" class="heart-separator">
                <svg viewBox="0 0 100 100" class="heart-svg">
                    <path d="M50,90 C-10,40 10,0 50,20 C90,0 110,40 50,90 Z" fill="#ff69b4"/>
                </svg>
            </div>
            
            <div class="time-group">
                <span id="seconds-number" class="number">00</span>
                <span class="label">Seconds</span>
            </div>
            
        </div>
        
    </div>

    <div id="heart-rain-container">
        <div id="final-screen" class="final-heart-container">
            <span class="final-text-message">
                Welcome<br>into my mess<br>Stella!
            </span>
        </div>
    </div>

    <script>
    let countdownInterval;
    const TARGET_DATE_STRING = "2025-11-24 15:40:00"; // La tua data target
    const countDownDateMs = new Date(TARGET_DATE_STRING).getTime(); 
    
    const heart1 = document.getElementById("heart-1");
    const heart2 = document.getElementById("heart-2");
    
    const fullScreenContent = document.querySelector(".full-screen-content"); 
    const finalScreen = document.getElementById("final-screen"); 
    const heartRainContainer = document.getElementById("heart-rain-container");

    /**
     * Riavvia l'animazione forzando il ricalcolo CSS, sincronizzando il battito.
     */
    function restartHeartAnimation() {
        const hearts = [heart1, heart2];
        hearts.forEach(heart => {
            heart.classList.remove("heart-animated");
            void heart.offsetWidth; 
            heart.classList.add("heart-animated");
        });
    }

    // --- FUNZIONI PER LA PIOGGIA DI CUORI ---
    const colors = ['#87CEEB', '#FF69B4']; // Azzurro (SkyBlue) e Rosa (HotPink)
    const numHearts = 50; 

    function createHeart() {
        const heart = document.createElement('div');
        heart.classList.add('rain-heart');
        const color = colors[Math.floor(Math.random() * colors.length)];
        heart.style.backgroundColor = color;
        
        const size = Math.random() * (60 - 30) + 30; // da 30px a 60px
        heart.style.width = `${size}px`;
        heart.style.height = `${size}px`;
        
        heart.style.transform = `rotate(${Math.random() * 360}deg)`;

        heart.style.left = `${Math.random() * 100}vw`;
        heart.style.top = `${-size}px`; 
        
        const duration = Math.random() * (10 - 5) + 5; // da 5s a 10s
        heart.style.animationDuration = `${duration}s`;
        heart.style.animationDelay = `${Math.random() * duration}s`; 
        
        heartRainContainer.appendChild(heart);
    }

    function startHeartRain() {
        // Nasconde il countdown
        fullScreenContent.style.display = 'none';
        
        // Mostra il contenitore della pioggia di cuori
        heartRainContainer.style.display = 'block'; 
        
        // Assicurati che il contenitore del TESTO FINALE sia visibile
        finalScreen.style.display = 'flex'; 

        for (let i = 0; i < numHearts; i++) {
            createHeart();
        }
    }
    // --- FINE FUNZIONI PER LA PIOGGIA DI CUORI ---


    function startCountdown() {
        if (countdownInterval) {
            clearInterval(countdownInterval);
        }
        
        fullScreenContent.style.display = 'flex';
        finalScreen.style.display = 'none'; // Il testo finale è nascosto
        heartRainContainer.style.display = 'none'; 
        
        document.getElementById("status-message").innerHTML = "";

        restartHeartAnimation(); 

        countdownInterval = setInterval(function() {

            const now = new Date().getTime();
            let distance = countDownDateMs - now;

            if (distance < 0) {
                clearInterval(countdownInterval);
                
                // GESTIONE FINE COUNTDOWN: Avvia la pioggia di cuori
                startHeartRain(); 
                
                return;
            }

            const totalHours = Math.floor(distance / (1000 * 60 * 60));
            const millisecondsLeftAfterHours = distance % (1000 * 60 * 60);
            const minutes = Math.floor(millisecondsLeftAfterHours / (1000 * 60));
            const millisecondsLeftAfterMinutes = distance % (1000 * 60);
            const seconds = Math.floor(millisecondsLeftAfterMinutes / 1000);
            
            const hoursDisplay = totalHours < 10 ? "0" + totalHours : totalHours;
            const minutesDisplay = minutes < 10 ? "0" + minutes : minutes;
            const secondsDisplay = seconds < 10 ? "0" + seconds : seconds;
            
            document.getElementById("hours-number").innerHTML = hoursDisplay;
            document.getElementById("minutes-number").innerHTML = minutesDisplay;
            document.getElementById("seconds-number").innerHTML = secondsDisplay;
            
            restartHeartAnimation();

        }, 1000); 
    }

    window.onload = startCountdown; 
    </script>

</body>
</html>
